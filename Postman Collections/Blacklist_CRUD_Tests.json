{
  "info": {
    "_postman_id": "564636bb-74da-471e-ab46-5b4ab5d424b3",
    "name": "Blacklist CRUD Tests",
    "schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
  },
  "item": [
    {
      "name": "Setup",
      "item": [
        {
          "name": "blacklist-domain/delete ",
          "_postman_id": "f19db5bd-7d2b-4199-ba4f-1edb47adf526",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "DELETE",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "domain_name",
                  "value": "test_original.com",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/api/admin/blacklist-domains/delete",
            "description": "clear test domain test_original.com from database"
          },
          "response": []
        },
        {
          "name": "blacklist-domain/delete",
          "_postman_id": "8c4352ef-7bfb-4ef7-8285-9f59c7b14fc3",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "DELETE",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "domain_name",
                  "value": "test_updated.com",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/api/admin/blacklist-domains/delete",
            "description": "clear test domain test_original.com from database"
          },
          "response": []
        },
        {
          "name": "sso/login",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "775e09c6-a5eb-42a1-8bd9-2155a0fdcc6e",
                "exec": [
                  "pm.globals.set(\"blacklist_domain\", \"test_original.com\");",
                  "pm.globals.set(\"blacklist_domain_updated\", \"test_updated.com\");"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "22702adc-4df1-45bf-b7e7-1ec1f7c4fb2c",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "username",
                  "value": "andrew@webtalk.co",
                  "type": "text"
                },
                {
                  "key": "password",
                  "value": "Test123",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/sso/login"
          },
          "response": []
        }
      ],
      "_postman_id": "747aa9b9-127e-4321-8920-db90506c05ac",
      "description": "Clear test domains from database if they exist",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "36731b49-6ac9-47c2-a0bb-bc8b07861800",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "id": "26c9bf27-1b4e-4068-8024-c4c0ce7c0c69",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        }
      ]
    },
    {
      "name": "Test",
      "item": [
        {
          "name": "blacklist-domains/save",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "64765eaa-daa2-452a-ab91-4b775e9bbd88",
                "exec": [
                  ""
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "5486059e-f755-4ea0-8080-319d13b9cac8",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "domain_name",
                  "value": "test_original.com",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/api/admin/blacklist-domains/save"
          },
          "response": []
        },
        {
          "name": "blacklist-domains/:domain_name",
          "event": [
            {
              "listen": "test",
              "script": {
                "id": "06a6b46a-16c2-47d7-86f5-9b4e524867cd",
                "exec": [
                  "pm.test(\"Retrieve inserted domain\", function () {",
                  "    let response = pm.response.json();",
                  "    pm.expect(response).to.have.ownProperty(\"data\"); ",
                  "    pm.expect(response.data).to.have.ownProperty(\"blacklist_domain\");",
                  "    pm.expect(response.data.blacklist_domain).to.equal(\"test_original.com\");",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "_postman_id": "6f465613-19b6-4f35-bf79-77a0d3fc1e8d",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [],
              "options": {
                "urlencoded": {}
              }
            },
            "url": {
              "raw": "{{host}}/api/admin/blacklist-domains/:domain_name",
              "host": [
                "{{host}}"
              ],
              "path": [
                "api",
                "admin",
                "blacklist-domains",
                ":domain_name"
              ],
              "variable": [
                {
                  "key": "domain_name",
                  "value": "test_original.com",
                  "type": "string"
                }
              ]
            },
            "description": "Get single domain name"
          },
          "response": []
        },
        {
          "name": "blacklist-domains/update",
          "_postman_id": "0a768dac-fd1f-4139-9e3f-de23befd1f48",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "old_domain_name",
                  "value": "test_original.com",
                  "type": "text"
                },
                {
                  "key": "new_domain_name",
                  "value": "test_updated.com",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/api/admin/blacklist-domains/update"
          },
          "response": []
        },
        {
          "name": "blacklist-domains/delete",
          "_postman_id": "eeb0233c-bf18-4267-b5ca-60c1c7963f92",
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "DELETE",
            "header": [],
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                {
                  "key": "domain_name",
                  "value": "test_updated.com",
                  "type": "text"
                }
              ],
              "options": {
                "urlencoded": {}
              }
            },
            "url": "{{host}}/api/admin/blacklist-domains/delete"
          },
          "response": []
        }
      ],
      "_postman_id": "bbc282ee-f0ed-4b5e-8174-305ef72243ad",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "e62bfd74-338e-4969-abc4-6f2d6cef4ff6",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "id": "b8f164e3-5181-4c84-a0eb-e7e63103acf8",
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Response is ok\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "let jsonResponse = pm.response.json();",
              "",
              "pm.test(\"Response should be a parsable JSON\", function() {",
              "    pm.expect(jsonResponse).to.be.ok;",
              "});",
              "",
              "pm.test(\"Response body should be an object\", function() {",
              "    pm.expect(jsonResponse).to.be.an('object');",
              "});",
              "",
              "pm.test(\"Success\", function () {",
              "    let response = pm.response.json();",
              "    pm.expect(response).to.have.ownProperty(\"type\"); ",
              "    pm.expect(response.type).to.equal(\"success\");",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Teardown",
      "item": [],
      "_postman_id": "e24087b0-a0cc-40a4-a12b-b0c880a004cb",
      "description": "Clear test domains from database if they exist",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "id": "62c99a97-c0a0-458f-af70-8616da7ed9cd",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "id": "94972749-534f-419d-9768-fd88f5901e9e",
            "type": "text/javascript",
            "exec": [
              ""
            ]
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "id": "219b4b89-bd9e-4548-88aa-81cffd3967c8",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "id": "07063c57-1a93-4e34-88a2-c30c3a473858",
        "type": "text/javascript",
        "exec": [
          ""
        ]
      }
    }
  ]
}